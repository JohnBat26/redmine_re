<div id='detail_view' class='detail_view'>
<h2><%= l(:re_task) %></h2>

<%= error_messages_for :re_task %>


<% form_for :re_task, :url => {:action => "edit"}, :html => { :style => "margin:0;padding:0;display:inline" } do |f| %>
    <%= hidden_field_tag :parent_id, params[:parent_id] %>
    
    <%= render "re_artifact_properties/shared_fields", :f => f, :properties => @re_task.re_artifact_properties %>
    <%= submit_tag l(:re_save) %>

    <p>
      <% if @subtasks.size == 0 %>
            <%= link_to_remote "Add Subtask", :url => {:action => "add_subtask", :add_position => :after} %>
     <% end %>
    </p>

    <table class="subtasks">
      <thead>
        <tr>
          <th>&nbsp;</th>
          <th>Type</th>
          <th>Name</th>
          <th>Solution</th>
          <th><%= link_to_remote l(:re_insert_st_before), :url => {:action => "add_subtask", :id => 'TODO-FIRST', :add_position => :before}, :html=> {:class => "icon icon-subtask-after"} %></th>
        </tr>
      </thead>
      <tbody id="subtasks">
        <%= render :partial => 're_subtask', :collection => @subtasks %>
      </tbody>
    </table>
    <%= sortable_element "subtasks",
                          :tag => 'tr',
                          :complete => visual_effect(:highlight, 'subtasks'),
                          :url => { :action => "update_subtask_positions" }
    %>
    <br />

<% end %>

<div class="manage_relationships">
    <%= render "re_artifact_properties/manage_relationships", :id => params[:id], :project_id => @project.id if params.has_key? :id  %>
</div>


<script type="text/javascript" language="javascript">
  changeSubtaskRowColor = function(element, value) {
    element.removeClassName('odd');
    element.removeClassName('variant');
    element.removeClassName('problem');
    
    switch(value) {
      case '0': element.addClassName('odd'); break;
      case '1': element.addClassName('variant'); break;
      case '2': element.addClassName('problem'); break;
      default: alert('You cannot switch to that value ' + value);
    }
  }

  $$('textarea.subtask').each(function (el) {
     new ResizingTextArea($(el));
  });
</script>
  
</div>
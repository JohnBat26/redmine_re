<h2>Task Versions</h2>

<style>
td {
  width:300px;
}
thead {
  background-color:#507aaa;
  color:#f8f8f8;
}
tr#odd {
  background-color:#a5bfff;
}
#taskinfo {
  margin-left:20px;
}
</style>



	<div id="taskinfo">
       <h4><%= @task.re_artifact.name %> </h4>
		<h5>Versionen:</h5>
		<table>
		<thead><tr><td>Nr:</td><td>Description</td><td>Updated</td><td>Updated by</td><td>Versioned By Artifact</td><td>action</td></tr></thead>
			<% @task.versions.each_with_index do |taskVersion, i| %>
				<tr class="<%= cycle('odd', 'even') %>">

                <td><%= taskVersion.version %></td>
                <td><%= taskVersion.description %></td>
                <td><%= taskVersion.updated_at.to_s  %></td>
                  <% user = User.find(taskVersion.updated_by) %>
                <td><%= link_to user.login, :controller => "users", :action => "show", :id => user %></td>  <%# TODO helper method %>

                   
                <td>
                     <% if taskVersion.versioned_by_artifact_id %>    <%# TODO: In Task Version neue spalte mit version des artifacts welches versionierung verusacht hat %>
                      <% re_artifact = ReArtifact.find(taskVersion.versioned_by_artifact_id.to_i) %>        
                      <%= link_to re_artifact.artifact_type , :controller => re_artifact.artifact_type.underscore, :action => "show_versions", :id => re_artifact.artifact_id , :project_id => @project.id, :version => (re_artifact.artifact.versions.detect{|v| v.updated_at == taskVersion.updated_at}).version %>
                     <% end %>
                </td>
                <% if(taskVersion.version != @task.version) %>
                    <td><%= link_to "ChangeToThis", :action => "change_version", :id => @task.id, :project_id => @project.id, :version => taskVersion.version  %></td>
				<% else %>
                    <td><%= "current" %></td>
                <% end %>

                </tr>

			<% end %>
		</table>
	</div>
<h4></h4>